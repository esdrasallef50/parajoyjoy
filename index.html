<!-- 
=========================================================================
# PEDIDO DE NAMORO IRRECUSAVEL - V30.0 (Vers√£o Final Limpa)

Status:
- Modo Diagn√≥stico removido (site pronto para envio).
- Fotos configuradas e ajustadas (sem cortes).
- Funcionalidades testadas e aprovadas.
=========================================================================
-->

<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Meta tag para ajudar no carregamento de imagens externas -->
    <meta name="referrer" content="no-referrer">
    <title>Uma Surpresa Para Voc√™ ‚ù§Ô∏è</title>
    
    <!-- FONTES -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        /* --- ESTILOS GERAIS & ANIMA√á√ÉO DE FUNDO --- */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(-45deg, #ffecec, #ffc3c3, #ff9a9e, #fad0c4);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        * { box-sizing: border-box; }

        /* --- ELEMENTOS DE FUNDO --- */
        #confetti-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 100; }
        .heart-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; overflow: hidden; }
        .heart {
            position: absolute; color: #ff9da9; opacity: 0.6; font-size: 20px;
            animation: float 6s infinite ease-in-out; text-shadow: 0 0 5px rgba(255, 157, 169, 0.5);
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        @keyframes jump-joy { 0% { transform: scale(1) translateY(0); } 50% { transform: scale(1.3) translateY(-15px); } 100% { transform: scale(1) translateY(0); } }
        .heart.jumping { color: #ff4d6d !important; opacity: 1 !important; animation: jump-joy 0.8s ease-in-out !important; }

        /* --- INTERFACE (GLASSMORPHISM REFINADO) --- */
        .glass-effect {
            background: rgba(255, 255, 255, 0.65); /* Mais opaco para leitura */
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.8); 
            box-shadow: 0 8px 32px 0 rgba(255, 77, 109, 0.2);
            transition: transform 0.3s ease;
        }
        
        .glass-effect:hover {
            box-shadow: 0 12px 40px 0 rgba(255, 77, 109, 0.3);
        }

        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 50; transition: opacity 0.8s ease;
        }
        .hidden { display: none !important; opacity: 0; pointer-events: none; }

        /* Login */
        .login-box { padding: 50px 40px; border-radius: 30px; text-align: center; width: 85%; max-width: 400px; display: flex; flex-direction: column; align-items: center; }
        .login-title { 
            color: #ff4d6d; margin-bottom: 5px; font-family: 'Great Vibes', cursive; 
            font-size: 4rem; line-height: 1.1; text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.8);
            letter-spacing: 2px;
            white-space: nowrap;
        }
        .login-subtitle { color: #666; font-size: 0.95rem; margin-bottom: 30px; font-weight: 300; letter-spacing: 0.5px; }
        
        .login-input { 
            width: 100%; max-width: 100%; padding: 15px; margin-bottom: 20px; 
            border: 2px solid transparent; border-radius: 15px; outline: none; 
            background: rgba(255,255,255,0.9); font-family: 'Poppins', sans-serif; 
            text-align: center; font-size: 1rem; color: #555;
            transition: all 0.3s ease; box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }
        .login-input:focus { border-color: #ff9da9; background: #fff; box-shadow: 0 0 15px rgba(255, 77, 109, 0.15); }
        
        .btn-login { 
            background: linear-gradient(45deg, #ff4d6d, #ff8fa3); 
            color: white; border: none; padding: 15px 40px; border-radius: 50px; 
            font-size: 1.1rem; cursor: pointer; width: 100%; font-weight: 600; 
            box-shadow: 0 4px 15px rgba(255, 77, 109, 0.3);
            transition: all 0.3s ease;
        }
        .btn-login:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(255, 77, 109, 0.4); }
        .btn-login:disabled { background: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }

        /* Quiz */
        .quiz-box { width: 90%; max-width: 480px; padding: 40px; border-radius: 30px; text-align: center; }
        .quiz-question { font-size: 1.3rem; color: #ff4d6d; margin-bottom: 25px; font-weight: 600; text-shadow: 1px 1px 0 #fff; }
        .quiz-options { display: flex; flex-direction: column; gap: 15px; }
        .btn-option { 
            background: white; border: 2px solid #ffdeebd5; color: #ff4d6d; 
            padding: 15px; border-radius: 20px; cursor: pointer; font-size: 1.05rem; 
            transition: all 0.3s ease; font-family: 'Poppins', sans-serif; font-weight: 500;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .btn-option:hover { background: #ff4d6d; color: white; border-color: #ff4d6d; transform: translateY(-2px); box-shadow: 0 6px 15px rgba(255, 77, 109, 0.2); }
        .quiz-textarea { width: 100%; padding: 15px; border-radius: 15px; border: 2px solid #ffdeebd5; font-family: 'Poppins', sans-serif; margin-bottom: 20px; resize: none; min-height: 120px; font-size: 1rem; outline: none; background: rgba(255,255,255,0.95); transition: border 0.3s; }
        .quiz-textarea:focus { border-color: #ff4d6d; }
        .btn-submit-quiz { 
            background: linear-gradient(45deg, #ff4d6d, #ff8fa3); color: white; border: none; 
            padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; width: 100%; 
            transition: all 0.3s; box-shadow: 0 4px 15px rgba(255, 77, 109, 0.3);
        }
        .btn-submit-quiz:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(255, 77, 109, 0.4); }
        
        .shake { animation: shake 0.5s; border-color: #ff4d6d !important; background-color: #ffecec !important; }
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); } }

        /* Pedido */
        #proposal-screen { overflow-y: auto; padding: 20px 0; }
        .carousel-container { 
            width: 90%; max-width: 400px; 
            aspect-ratio: 3/4; 
            max-height: 55vh; 
            border-radius: 25px; 
            overflow: hidden; margin-bottom: 25px; position: relative; padding: 10px; 
            background: rgba(255, 255, 255, 0.3); backdrop-filter: blur(8px); 
            border: 2px solid white; box-shadow: 0 15px 35px rgba(255, 77, 109, 0.15); 
        }
        .carousel-inner { 
            width: 100%; height: 100%; border-radius: 18px; 
            overflow: hidden; position: relative; 
            background: rgba(255, 240, 245, 0.3); 
        }
        .carousel-slide { 
            width: 100%; height: 100%; 
            object-fit: contain; 
            position: absolute; top: 0; left: 0; 
            opacity: 0; transition: opacity 1s ease-in-out; 
        }
        .carousel-slide.active { opacity: 1; transform: scale(1); }
        
        .typing-container { margin-bottom: 30px; height: 70px; display: flex; align-items: center; justify-content: center; }
        #main-question { 
            color: #ff4d6d; font-family: 'Great Vibes', cursive; font-size: 4rem; 
            text-shadow: 2px 2px 0px rgba(255,255,255,0.9); margin: 0; 
            line-height: 1;
        }
        
        /* ANIMA√á√ÉO DE PULSO */
        @keyframes subtlePulse {
            0% { transform: scale(1); text-shadow: 2px 2px 0px rgba(255,255,255,0.8); }
            50% { transform: scale(1.05); text-shadow: 4px 4px 2px rgba(255,255,255,0.5); }
            100% { transform: scale(1); text-shadow: 2px 2px 0px rgba(255,255,255,0.8); }
        }
        .pulsing-text { animation: subtlePulse 2s infinite ease-in-out; }

        .botoes-container { display: flex; gap: 20px; margin-bottom: 30px; justify-content: center; align-items: center; height: 70px; width: 100%; }
        .btn-proposal { 
            padding: 15px 40px; font-size: 1.2rem; border-radius: 50px; cursor: pointer; 
            font-weight: 700; border: none; transition: all 0.3s; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); font-family: 'Poppins', sans-serif; 
            text-transform: uppercase; letter-spacing: 1px;
        }
        .btn-sim { background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; }
        .btn-sim:hover { transform: scale(1.1) translateY(-2px); box-shadow: 0 10px 25px rgba(46, 204, 113, 0.4); }
        .btn-nao { background: white; color: #e74c3c; border: 2px solid #e74c3c; z-index: 20; }
        
        .btn-letter { 
            background: rgba(255, 255, 255, 0.8); color: #ff4d6d; border: 2px solid #ff4d6d; 
            padding: 10px 30px; border-radius: 25px; cursor: pointer; font-size: 1rem; 
            margin-bottom: 25px; display: flex; align-items: center; gap: 10px; 
            font-family: 'Poppins', sans-serif; backdrop-filter: blur(4px); font-weight: 600;
            transition: all 0.3s;
        }
        .btn-letter:hover { background: #ff4d6d; color: white; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(255, 77, 109, 0.3); }

        /* Modal */
        #letter-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 60; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .letter-content { 
            background: #fffdf9; width: 85%; max-width: 550px; padding: 50px; border-radius: 20px; 
            position: relative; text-align: center; animation: slideUp 0.5s ease; 
            background-image: url('https://www.transparenttextures.com/patterns/paper.png'); 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); border: 10px solid rgba(255,255,255,0.5);
        }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .close-letter { position: absolute; top: 15px; right: 20px; font-size: 32px; cursor: pointer; color: #bbb; transition: color 0.3s; }
        .close-letter:hover { color: #ff4d6d; }
        .letter-text { font-family: 'Great Vibes', cursive; font-size: 2rem; color: #555; line-height: 1.5; margin-top: 20px; }

        /* Extras */
        .music-control { 
            position: fixed; top: 20px; right: 20px; z-index: 1000; 
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(5px); 
            border-radius: 50%; width: 50px; height: 50px; display: none; 
            justify-content: center; align-items: center; cursor: pointer; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 2px solid #ff4d6d; 
            font-size: 24px; transition: all 0.3s;
        }
        .music-control:hover { transform: scale(1.1) rotate(10deg); }
        
        #youtube-player-container { position: absolute; width: 1px; height: 1px; left: -9999px; opacity: 0; pointer-events: none; }

        /* --- ANIMA√á√ÉO APENAS DO CORA√á√ÉO --- */
        #rings-container {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 200; justify-content: center; align-items: center; pointer-events: none;
        }
        
        /* Cora√ß√£o Gigante no Fundo */
        .glowing-heart {
            position: absolute; font-size: 350px; color: #ff2a50; opacity: 0;
            z-index: 100; text-shadow: 0 0 30px rgba(255, 42, 80, 0.8), 0 0 80px rgba(255, 42, 80, 0.6);
            transform: scale(0);
        }

        .animate-rings .glowing-heart {
            animation: fadeInHeart 1s forwards ease-out 0.5s, pulseHeart 2s infinite ease-in-out 1.5s;
        }

        @keyframes fadeInHeart {
            0% { opacity: 0; transform: scale(0); }
            100% { opacity: 1; transform: scale(1); }
        }
        @keyframes pulseHeart {
            0% { transform: scale(1); text-shadow: 0 0 30px rgba(255, 42, 80, 0.8); }
            50% { transform: scale(1.3); text-shadow: 0 0 60px rgba(255, 42, 80, 1); } /* Aumentado para 1.3 */
            100% { transform: scale(1); text-shadow: 0 0 30px rgba(255, 42, 80, 0.8); }
        }

        /* --- CHUVA DE ELOGIOS --- */
        .love-note {
            position: absolute; color: #ff4d6d; font-family: 'Great Vibes', cursive;
            font-weight: bold; pointer-events: none; z-index: 150;
            animation: floatUp 3s forwards ease-out;
            text-shadow: 2px 2px 0px white;
        }
        
        @keyframes floatUp {
            0% { opacity: 0; transform: translateY(0) scale(0.5); }
            20% { opacity: 1; transform: translateY(-20px) scale(1.2); }
            100% { opacity: 0; transform: translateY(-100px) scale(1); }
        }

        /* --- BOT√ÉO FLUTUANTE CHUCHU --- */
        .btn-chuchu {
            position: fixed; bottom: 30px; right: 30px;
            background: white; border: 2px solid #ff4d6d; color: #ff4d6d;
            padding: 12px 25px; border-radius: 50px; font-size: 1rem;
            font-family: 'Poppins', sans-serif; font-weight: bold;
            cursor: pointer; z-index: 1000; box-shadow: 0 5px 20px rgba(255, 77, 109, 0.3);
            display: none; /* S√≥ aparece na tela final */
            align-items: center; gap: 10px; transition: all 0.3s ease;
            animation: floatBtn 3s ease-in-out infinite;
        }

        .btn-chuchu:hover {
            transform: translateY(-5px) scale(1.05);
            background: #ff4d6d; color: white;
            box-shadow: 0 8px 25px rgba(255, 77, 109, 0.5);
        }

        @keyframes floatBtn {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* --- TOAST NOTIFICATION (Substituto do Alert) --- */
        .toast {
            position: fixed; top: 30px; left: 50%; transform: translateX(-50%) translateY(-100px);
            background: white; color: #ff4d6d; padding: 15px 30px;
            border-radius: 50px; font-family: 'Poppins', sans-serif; font-weight: 600;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); border: 2px solid #ff4d6d;
            z-index: 2000; transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            display: flex; align-items: center; gap: 10px;
        }
        .toast.show { transform: translateX(-50%) translateY(0); }
    </style>
</head>

<body>
    <!-- 1. MAPA DE IMPORTA√á√ÉO -->
    <script type="importmap">
      {
        "imports": {
          "firebase/app": "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js",
          "firebase/auth": "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js",
          "firebase/firestore": "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"
        }
      }
    </script>

    <!-- 2. SCRIPT DE DADOS (FIREBASE MODULE) -->
    <script type="module">
        // @ts-nocheck
        import { initializeApp } from 'firebase/app';
        import { getAuth, signInAnonymously } from 'firebase/auth';
        import { getFirestore, collection, addDoc, setDoc, doc, serverTimestamp } from 'firebase/firestore';

        // --- CONFIGURA√á√ÉO MANUAL FOR√áADA ---
        const firebaseConfig = {
            apiKey: "AIzaSyBZu26BHXzH7ry5Tjq3cSLg6Xh4ogl-vig",
            authDomain: "pedido-c76e7.firebaseapp.com",
            projectId: "pedido-c76e7",
            storageBucket: "pedido-c76e7.firebasestorage.app",
            messagingSenderId: "966916465038",
            appId: "1:966916465038:web:1a5703b4b60688490b44df"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = 'pedido-namoro-v1';
        let isOfflineMode = false;

        const initApp = async () => {
            try {
                console.log("Iniciando conex√£o segura...");
                await signInAnonymously(auth);
                console.log("üî• Firebase: Conectado e Autenticado!");
                await inicializarColecoes();
            } catch (error) {
                console.error("Erro Firebase:", error.code);
                // N√£o alertamos erro de auth para n√£o assustar o usu√°rio, apenas fallback
                isOfflineMode = true;
            }
        };
        initApp();

        const inicializarColecoes = async () => {
            if (isOfflineMode) return;
            try {
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'aceites', '_info'), {
                    criado_em: serverTimestamp(), descricao: "Registros de aceite"
                }, { merge: true });

                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'respostas_amor', '_info'), {
                    criado_em: serverTimestamp(), descricao: "Respostas do quiz"
                }, { merge: true });
            } catch (e) {
                console.warn("Erro ao inicializar cole√ß√µes:", e);
            }
        };

        // --- FUN√á√ïES DE SALVAMENTO ---
        window.aceitou = function() {
            if (typeof window.celebrar === 'function') window.celebrar();
            if (typeof window.mostrarCoracaoFinal === 'function') window.mostrarCoracaoFinal();
            if (typeof window.chuvaDeElogios === 'function') window.chuvaDeElogios();
            
            if (!isOfflineMode && auth.currentUser) {
                addDoc(collection(db, 'aceites'), {
                    aceitou: true,
                    data: serverTimestamp(),
                    motivos: window.loveReasons || "N√£o preencheu",
                    user_id: auth.currentUser.uid
                }).then(() => console.log("üíæ Aceite salvo no banco!"));
            } else {
                localStorage.setItem('namoro_aceito', 'true');
            }

            setTimeout(() => {
                // Mensagem personalizada para o WhatsApp
                let mensagem = "Oii amor, adorei a surpresa, claro que eu aceito meu lindo, te amo!";
                
                if (window.loveReasons) {
                    mensagem += "\n\n(Ah, e sobre as coisas que eu amo em voc√™: " + window.loveReasons + ")";
                }
                
                // --- ATEN√á√ÉO: COLOQUE SEU N√öMERO AQUI (Ex: 5511999991234) ---
                const SEU_NUMERO_WHATSAPP = "5511993167368"; 
                const YOUTUBE_VIDEO_ID = "lm50i_r-pd8"; 
                
                if (SEU_NUMERO_WHATSAPP === "") location.href = `https://www.youtube.com/watch?v=${YOUTUBE_VIDEO_ID}`;
                else window.location.href = `https://api.whatsapp.com/send?phone=${SEU_NUMERO_WHATSAPP}&text=${encodeURIComponent(mensagem)}`;
            }, 4000);
        };

        window.salvarRespostaTexto = function() {
            const text = document.getElementById('love-text').value;
            if (text.trim().length < 3) {
                window.showToast("Por favor, escreva algo bonitinho! ü•∫"); // ALERT SUBSTITU√çDO
                return;
            }
            window.loveReasons = text; 

            if (!isOfflineMode && auth.currentUser) {
                addDoc(collection(db, 'respostas'), {
                    resposta: text,
                    data: serverTimestamp(),
                    user_id: auth.currentUser.uid
                }).then(() => console.log("üíæ Resposta salva no banco!"));
            } else {
                localStorage.setItem('namoro_motivos', text);
            }

            if (typeof window.proximaPergunta === 'function') window.proximaPergunta();
        };
    </script>

    <!-- 3. SCRIPT GLOBAL (Interface e L√≥gica Visual) -->
    <script>
        // @ts-nocheck
        /* --- VARI√ÅVEIS GLOBAIS --- */
        // ID da m√∫sica (Delacruz)
        const YOUTUBE_VIDEO_ID = "lm50i_r-pd8"; 
        const SEU_NUMERO_WHATSAPP = "5511993167368"; // Coloque aqui tamb√©m se quiser usar no bot√£o Chuchu
        
        const frasesNao = ["N√£o?", "Tem certeza?", "Pense bem...", "N√£o faz isso!", "Vou chorar...", "S√©rio?", "Clica no Sim!", "üíî"];
        
        window.loveReasons = "";
        let player;
        let isPlayerReady = false;
        let isMusicPlaying = false;
        let slideIndex = 0;
        let currentQuizIndex = 0;
        let carouselTimer = null;

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function tocarSomAcerto() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1046.5, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function tocarSomErro() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }

        const quizQuestions = [
            { 
                type: 'choice', 
                question: "Quem √© mais prov√°vel de se irritar com mais facilidade?", 
                answers: [ 
                    { text: "Allef o Calmo", correct: false }, 
                    { text: "Joy a Esquentadinha", correct: true } 
                ] 
            },
            { 
                type: 'choice', 
                question: "Onde foi nosso primeiro beijo?", 
                answers: [ 
                    { text: "No Cinema", correct: false }, 
                    { text: "No Bruder", correct: true }, 
                    { text: "Na Escola", correct: false } 
                ] 
            },
            { 
                type: 'text', 
                question: "Quais s√£o as coisas que fizeram voc√™ se apaixonar por mim? Cite 3 coisas:", 
                placeholder: "Escreva aqui (vou ler depois)..." 
            }
        ];

        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        window.onYouTubeIframeAPIReady = function() {
            player = new YT.Player('player', {
                height: '200', width: '200', videoId: YOUTUBE_VIDEO_ID,
                playerVars: { 
                    'playsinline': 1, 
                    'controls': 0, 
                    'loop': 1, 
                    'playlist': YOUTUBE_VIDEO_ID, 
                    'autoplay': 0 
                },
                events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange }
            });
        }
        function onPlayerReady(event) { isPlayerReady = true; event.target.setVolume(100); }
        function onPlayerStateChange(event) {
            const btn = document.getElementById('music-btn');
            if (event.data == YT.PlayerState.PLAYING) { isMusicPlaying = true; btn.innerHTML = 'üîä'; }
            else { isMusicPlaying = false; btn.innerHTML = 'üîá'; }
        }

        window.fazerLogin = function() {
            const btnEntrar = document.getElementById('btn-entrar');
            if(btnEntrar) { btnEntrar.disabled = true; btnEntrar.innerText = "Entrando..."; }
            document.getElementById('loading-msg').style.display = 'block';

            if (player && typeof player.playVideo === 'function') {
                player.unMute();
                player.setVolume(100);
                player.playVideo();
                isMusicPlaying = true;
                document.getElementById('music-btn').style.display = 'flex';
                document.getElementById('music-btn').innerHTML = 'üîä';
            } else {
                setTimeout(() => {
                    if (player && typeof player.playVideo === 'function') {
                        player.unMute();
                        player.setVolume(100);
                        player.playVideo();
                        document.getElementById('music-btn').style.display = 'flex';
                    }
                }, 1000);
            }
            
            document.querySelectorAll('.heart').forEach(h => {
                h.classList.add('jumping');
                setTimeout(() => { h.classList.remove('jumping'); }, 1000); 
            });

            if (audioCtx.state === 'suspended') audioCtx.resume();

            setTimeout(() => {
                const loginScreen = document.getElementById('login-screen');
                loginScreen.style.opacity = '0';
                setTimeout(() => {
                    loginScreen.classList.add('hidden');
                    const quizScreen = document.getElementById('quiz-screen');
                    quizScreen.classList.remove('hidden');
                    window.carregarPergunta();
                }, 1000);
            }, 1500);
        };

        window.carregarPergunta = function() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';
            const q = quizQuestions[currentQuizIndex];
            
            const qTitle = document.createElement('div');
            qTitle.className = 'quiz-question'; qTitle.innerText = q.question;
            container.appendChild(qTitle);
            
            if (q.type === 'text') {
                const textarea = document.createElement('textarea');
                textarea.className = 'quiz-textarea'; textarea.id = 'love-text'; textarea.placeholder = q.placeholder;
                container.appendChild(textarea);
                const btn = document.createElement('button');
                btn.className = 'btn-submit-quiz'; btn.innerText = "Enviar e Ver Surpresa ‚ù§Ô∏è";
                btn.onclick = window.salvarRespostaTexto; 
                container.appendChild(btn);
            } else {
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'quiz-options';
                q.answers.forEach(ans => {
                    const btn = document.createElement('button');
                    btn.className = 'btn-option'; btn.innerText = ans.text;
                    btn.onclick = () => window.verificarResposta(ans.correct, btn);
                    optionsDiv.appendChild(btn);
                });
                container.appendChild(optionsDiv);
            }
        }

        window.verificarResposta = function(isCorrect, btnElement) {
            if (isCorrect) {
                tocarSomAcerto(); 
                window.proximaPergunta();
            } else {
                tocarSomErro(); 
                btnElement.classList.add('shake'); btnElement.innerText = "Ops! Tente de novo üòÖ";
                setTimeout(() => { btnElement.classList.remove('shake'); }, 500);
            }
        }

        window.proximaPergunta = function() {
            currentQuizIndex++;
            if (currentQuizIndex < quizQuestions.length) window.carregarPergunta();
            else window.finalizarQuiz();
        }

        window.finalizarQuiz = function() {
            const quizScreen = document.getElementById('quiz-screen');
            quizScreen.style.opacity = '0';
            setTimeout(() => {
                quizScreen.classList.add('hidden');
                const proposalScreen = document.getElementById('proposal-screen');
                proposalScreen.classList.remove('hidden');
                setTimeout(() => { 
                    proposalScreen.style.opacity = '1'; 
                    window.typeWriter("Aceita namorar comigo?", "main-question", 100);
                    
                    slideIndex = 0;
                    if (carouselTimer) clearTimeout(carouselTimer);
                    window.showSlides(); 
                    
                    // MOSTRA O BOT√ÉO CHUCHU
                    document.getElementById('btn-chuchu').style.display = 'flex';
                }, 50);
            }, 800);
        }

        window.desvia = function(btn) {
            btn.style.position = 'absolute';
            btn.style.bottom = window.geraPosicao(10, 80);
            btn.style.left = window.geraPosicao(10, 80);
            btn.innerText = frasesNao[Math.floor(Math.random() * frasesNao.length)];
        };

        window.geraPosicao = function(min, max) { return (Math.random() * (max - min) + min) + "%"; }
        window.toggleMusic = function() { if (player && isPlayerReady) isMusicPlaying ? player.pauseVideo() : player.playVideo(); };
        window.abrirCarta = function() { document.getElementById('letter-modal').style.display = 'flex'; };
        window.fecharCarta = function() { document.getElementById('letter-modal').style.display = 'none'; };
        
        // NOVO: Fun√ß√£o Toast para substituir Alert
        window.showToast = function(msg) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `<span>‚ö†Ô∏è</span> ${msg}`;
            document.body.appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        }

        window.falarComChuchu = function() {
            const msg = "Oi Chuchu!";
            const phone = SEU_NUMERO_WHATSAPP;
            if (phone === "") {
                window.showToast("Voc√™ esqueceu de configurar o n√∫mero!"); // ALERT SUBSTITU√çDO
            } else {
                window.location.href = `https://api.whatsapp.com/send?phone=${phone}&text=${encodeURIComponent(msg)}`;
            }
        };

        window.typeWriter = function(text, elementId, speed) {
            const element = document.getElementById(elementId); 
            element.innerHTML = "";
            element.classList.remove('pulsing-text'); 
            let i = 0;
            function type() { 
                if (i < text.length) { 
                    element.innerHTML += text.charAt(i); i++; 
                    setTimeout(type, speed); 
                } else {
                    element.classList.add('pulsing-text');
                }
            }
            type();
        }

        window.criarCoracoes = function() {
            const bg = document.getElementById('heart-bg');
            for (let i = 0; i < 40; i++) {
                const heart = document.createElement('div'); heart.className = 'heart'; heart.innerHTML = '‚ù§';
                heart.style.left = Math.random() * 100 + 'vw'; heart.style.top = Math.random() * 100 + 'vh';
                heart.style.fontSize = (Math.random() * 20 + 10) + 'px'; heart.style.animationDelay = (Math.random() * 5) + 's';
                bg.appendChild(heart);
            }
        }

        window.showSlides = function() {
            const slides = document.getElementsByClassName("carousel-slide");
            if (slides.length === 0) return;
            for (let i = 0; i < slides.length; i++) { slides[i].classList.remove("active"); }
            slideIndex++; if (slideIndex > slides.length) slideIndex = 1;
            slides[slideIndex - 1].classList.add("active");
            
            carouselTimer = setTimeout(window.showSlides, 3000); 
        }

        window.celebrar = function() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            const pieces = [];
            for (let i = 0; i < 150; i++) pieces.push({
                x: Math.random() * canvas.width, y: Math.random() * canvas.height - canvas.height,
                color: `hsl(${Math.random() * 360}, 100%, 50%)`, size: Math.random() * 5 + 5, speed: Math.random() * 5 + 2
            });
            function update() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                pieces.forEach(p => { ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, p.size, p.size); p.y += p.speed; if (p.y > canvas.height) p.y = 0; });
                requestAnimationFrame(update);
            }
            update();
        }
        
        // --- CHUVA DE ELOGIOS ---
        window.chuvaDeElogios = function() {
            const elogios = ["Linda", "Perfeita", "Maravilhosa", "Minha Vida", "Te Amo", "Meu Tudo", "Princesa", "Gostosa", "√önica", "Cheirosa", "Inteligente"];
            const container = document.body;
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const el = document.createElement('div');
                    el.classList.add('love-note');
                    el.innerText = elogios[Math.floor(Math.random() * elogios.length)];
                    el.style.left = Math.random() * 90 + 'vw';
                    el.style.top = (Math.random() * 50 + 40) + 'vh';
                    el.style.fontSize = (Math.random() * 1.5 + 1) + 'rem';
                    container.appendChild(el);
                    
                    // Remove do DOM ap√≥s a anima√ß√£o
                    setTimeout(() => el.remove(), 3000);
                }, i * 100);
            }
        }
        
        window.mostrarCoracaoFinal = function() {
            const container = document.getElementById('rings-container');
            container.style.display = 'flex';
            container.classList.add('animate-rings');
        }

        // Init
        window.onload = function() { window.criarCoracoes(); window.showSlides(); };
        window.onclick = function(event) { if (event.target == document.getElementById('letter-modal')) window.fecharCarta(); }
    </script>

    <!-- UI ELEMENTS -->
    <div id="youtube-player-container"><div id="player"></div></div>
    <div id="music-btn" class="music-control" onclick="window.toggleMusic()">üîä</div>
    
    <!-- NOVO BOT√ÉO CHUCHU (INICIALMENTE ESCONDIDO) -->
    <button id="btn-chuchu" class="btn-chuchu" onclick="window.falarComChuchu()">
        <span>üí¨</span> Falar com Chuchu
    </button>
    
    <!-- CONTAINER ALIAN√áAS -->
    <div id="rings-container">
        <!-- Cora√ß√£o Gigante no Fundo -->
        <div class="glowing-heart">‚ù§</div>
        
        <!-- TEXTURA DE RU√çDO -->
        <div class="noise-overlay"></div>
    </div>
    
    <canvas id="confetti-canvas"></canvas>
    <div id="heart-bg" class="heart-bg"></div>

    <!-- TELA 1: LOGIN -->
    <div id="login-screen" class="screen">
        <div class="login-box glass-effect">
            <h1 class="login-title">√Årea Restrita</h1>
            <p class="login-subtitle">Acesso exclusivo para o amor da minha vida</p>
            <input type="password" placeholder="Senha (opcional)" class="login-input">
            <button id="btn-entrar" class="btn-login" onclick="window.fazerLogin()">Entrar</button>
            <p id="loading-msg" style="display:none; color: #777; font-size: 0.8rem; margin-top: 10px;">Carregando nosso momento...</p>
        </div>
    </div>

    <!-- TELA 2: QUIZ -->
    <div id="quiz-screen" class="screen hidden">
        <div class="quiz-box glass-effect">
            <h2 style="color: #ff4d6d; font-family: 'Great Vibes', cursive; font-size: 2.5rem; margin-bottom: 10px;">Teste de Amor ‚ù§Ô∏è</h2>
            <p style="margin-bottom: 20px; color: #666; font-size: 0.9rem;">Responda certo para desbloquear o pedido!</p>
            <div id="quiz-container"></div>
        </div>
    </div>

    <!-- TELA 3: PEDIDO -->
    <div id="proposal-screen" class="screen hidden">
        <div class="carousel-container">
            <div class="carousel-inner">
                <!-- Imagens do Drive (Formato Thumbnail - Mais Confi√°vel) -->
                <!-- Usei o formato 'thumbnail?id=' e adicionei onerror para fallback -->
                <img src="https://drive.google.com/thumbnail?id=10B2V98_HeQLDrWE8o6QS6qhhExG0H9r8&sz=w1000" class="carousel-slide active" alt="Foto 1" onerror="this.src='https://placehold.co/300x400?text=Erro+Foto+1';">
                <img src="https://drive.google.com/thumbnail?id=1L6xnmDy5v0x8p1DDnkdQwtD5rrvp_-7J&sz=w1000" class="carousel-slide" alt="Foto 2" onerror="this.src='https://placehold.co/300x400?text=Erro+Foto+2';">
                <img src="https://drive.google.com/thumbnail?id=1OBQONrb4dOloHVFnTBycwkwQIy-8fq1e&sz=w1000" class="carousel-slide" alt="Foto 3" onerror="this.src='https://placehold.co/300x400?text=Erro+Foto+3';">
                <img src="https://drive.google.com/thumbnail?id=1h81mYUzP25CNf2kyhB0Kx5_y36Ipl14E&sz=w1000" class="carousel-slide" alt="Foto 4" onerror="this.src='https://placehold.co/300x400?text=Erro+Foto+4';">
                <img src="https://drive.google.com/thumbnail?id=1k6X2CKOiQom2jvLCG30d5KsJCg_F33ym&sz=w1000" class="carousel-slide" alt="Foto 5" onerror="this.src='https://placehold.co/300x400?text=Erro+Foto+5';">
                <img src="https://drive.google.com/thumbnail?id=1m6yBHCBmikmrsVWv3j2isQ0x90NVcAm1&sz=w1000" class="carousel-slide" alt="Foto 6" onerror="this.src='https://placehold.co/300x400?text=Erro+Foto+6';">
            </div>
        </div>
        <button class="btn-letter" onclick="window.abrirCarta()"><span>üíå</span> Ler carta especial</button>
        <div class="typing-container"><h2 id="main-question"></h2></div>
        <div class="botoes-container">
            <button class="btn-proposal btn-sim" onclick="window.aceitou()">SIM</button>
            <button id="btn-nao" class="btn-proposal btn-nao" ontouchstart="window.desvia(this)" onmouseover="window.desvia(this)" onclick="window.desvia(this)">N√ÉO</button>
        </div>
    </div>

    <!-- MODAL CARTA -->
    <div id="letter-modal">
        <div class="letter-content glass-effect" style="background: white;">
            <span class="close-letter" onclick="window.fecharCarta()">&times;</span>
            <h3 style="color: #ff4d6d; margin-top: 0; font-family: 'Poppins', sans-serif;">Para voc√™...</h3>
            <div class="letter-text">
                <p>Desde que voc√™ chegou, tudo ficou mais colorido. Eu n√£o consigo mais imaginar meus dias sem o seu sorriso.</p>
                <p>Preparei esse site simples, mas de todo cora√ß√£o, para te fazer uma pergunta que pode mudar nossas vidas...</p>
                <p style="text-align: right; font-size: 1.5rem; margin-top: 30px;">Com amor,<br><strong>Allef</strong></p>
            </div>
        </div>
    </div>
</body>
</html>